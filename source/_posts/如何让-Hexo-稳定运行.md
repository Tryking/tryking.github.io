---
title: å¦‚ä½•è®© Hexo åœ¨æœåŠ¡å™¨ç¨³å®šè¿è¡Œ
date: 2019-06-09 13:17:01
tags: Hexo blog
---
# èƒŒæ™¯
åšå®¢ç³»ç»Ÿç»ˆäºŽåˆæ­å»ºèµ·æ¥äº†ï¼ˆå¥½ä¸€ä¸ªåˆðŸ˜¶ï¼‰ï¼Œä½†æ˜¯æ¯éš”ä¸€æ®µæ—¶é—´åŽ»è®¿é—®è‡ªå·±çš„ç½‘ç«™æ€»æ˜¯è®¿é—®ä¸åˆ°ï¼ŒåŽ»æœåŠ¡å™¨æŸ¥è¯¢ `ps aux | grep hexo`ï¼Œå‘çŽ° Hexo è¿›ç¨‹å·²ç»æŒ‚æŽ‰äº†ï¼Œæƒ³ç€è‡ªå·±ç”¨å‘½ä»¤ `nohup hexo s -p 8080 > server.log` å¯åŠ¨åº”è¯¥æ²¡é—®é¢˜å•Šï¼Œæ— å¥ˆä¹Ÿæ‰¾ä¸åˆ°åœæ­¢çš„ç›¸å…³æ—¥å¿—ï¼Œæ‰€ä»¥å¦å¯»å‡ºè·¯ï¼šæ‰¾ä¸€ä¸ªèƒ½å®žçŽ°å®ˆæŠ¤è¿›ç¨‹ç›‘æŽ§æœåŠ¡çš„ä¸œè¥¿ï¼Œå¦‚æžœæœåŠ¡æŒ‚æŽ‰äº†å°±è‡ªåŠ¨é‡å¯ã€‚

é¦–å…ˆæƒ³åˆ°çš„å°±æ˜¯å†™ä¸€ä¸ª `shell` è„šæœ¬åŽ»è¿›è¡Œï¼Œæ¯éš”å›ºå®šæ—¶é—´åŽ»æŸ¥è¯¢ Hexo è¿›ç¨‹æ˜¯å¦å·²ç»å¯åŠ¨ï¼Œæ²¡æœ‰çš„è¯é‡æ–°å¯åŠ¨ã€‚ä½†æ˜¯åœ¨å®žçŽ°ä¹‹å‰æˆ‘å…ˆåŽ»ç½‘ä¸Šæœäº†ä¸€æŠŠï¼Œå‘çŽ°äº†ä¸€ä¸ªç¥žå™¨ï¼š`PM2`ã€‚

`PM2` æ˜¯ node çš„è¿›ç¨‹ç®¡ç†å·¥å…·ï¼Œåˆ©ç”¨å®ƒå¯ä»¥ç®€åŒ–å¾ˆå¤š`node`åº”ç”¨ç®¡ç†çš„ç¹çä»»åŠ¡ï¼Œåƒæ€§èƒ½ç›‘æŽ§ã€è‡ªåŠ¨é‡å¯ç­‰å®ƒéƒ½èƒ½å®žçŽ°ï¼Œå·§çš„æ˜¯ï¼Œ Hexo ä¾¿æ˜¯ä¸€ä¸ª node åº”ç”¨ï¼Œå› æ­¤åœ¨è¿™é‡Œæˆ‘é‡‡ç”¨ `PM2` æ¥è¿›è¡Œåšå®¢æœåŠ¡çš„è‡ªåŠ¨é‡å¯åŠŸèƒ½ã€‚

# æ­¥éª¤

* é¦–å…ˆï¼Œå®‰è£… `MP2`
 
	```
	npm install pm2 -g
	```
* ç„¶åŽåœ¨æˆ‘ä»¬å¯åŠ¨æœåŠ¡çš„ç›®å½•ä¸‹æ–°å»ºä¸€ä¸ª `js` è„šæœ¬æ–‡ä»¶ï¼š`hexo-auto.js`ï¼Œå†…å®¹å¦‚ä¸‹ï¼š

	```
	var exec = require('child_process').exec;
	var cmd = 'nohup hexo s -p 8080 >> server.log &';
	
	exec(cmd, function(error, stdout, stderr) {
	  process.exit(0);
	});
	```
* æœ€åŽï¼Œæ‰§è¡Œå‘½ä»¤ï¼š`pm2 start hexo-auto.js`ï¼Œå½“é¡µé¢å‡ºçŽ°ä»¥ä¸‹å†…å®¹æ—¶ï¼Œè¡¨ç¤ºæˆ‘ä»¬æˆåŠŸäº†ã€‚

	![pm2](http://media.dengkaiting.com/PM2.png)
	
	å›¾ä¸­æ‰€ç¤ºè¡¨ç¤ºçš„æ˜¯æˆ‘ä»¬åœ¨åŽå° fork äº†ä¸€ä¸ªå­è¿›ç¨‹æ¥è¿è¡Œ Hexo æœåŠ¡ï¼Œå½“ Hexo è¿›ç¨‹é€€å‡ºæ—¶ï¼Œå­è¿›ç¨‹ä¹Ÿéšä¹‹é€€å‡ºã€‚PM2 ç›‘æŽ§åˆ°ä¹‹åŽä¼šè‡ªåŠ¨é‡å¯è¯¥è¿›ç¨‹ã€‚
	
# å¸¸ç”¨çš„ PM2 å‘½ä»¤
* æŸ¥çœ‹è¿›ç¨‹çŠ¶æ€

	```
	pm2 list
	```
* åœæ­¢åº”ç”¨

	```
	pm2 stop id|name|all|json|stdin
	```
	> å…¶ä¸­ï¼Œall ä¼šå°†æ‰€æœ‰åº”ç”¨ç»ˆæ­¢ï¼›id ä¸º `pm2 list` æŸ¥è¯¢å‡ºæ¥çš„ idï¼Œname ä¸º `pm2 list` æŸ¥è¯¢å‡ºæ¥çš„ nameã€‚å…¶ä½™ä¸¤ä¸ªæš‚æ—¶è¿˜ä¸æ¸…æ¥šã€‚
	
* é‡å¯åº”ç”¨

	```
	pm2 restart id|name|all|json|stdin
	```
	> å‚æ•°å«ä¹‰åŒ `pm2 stop`
	
* åˆ é™¤åº”ç”¨

	```
	pm2 delete name|id|script|all|json|stdin
	```
	> å‚æ•°å«ä¹‰åŒ `pm2 stop`

* æŸ¥çœ‹æŸä¸ªåº”ç”¨çš„ä¿¡æ¯ 

	```
	pm2 describe name|id
	```
	> å‚æ•°å«ä¹‰åŒ `pm2 stop`

# åŽç»­é—®é¢˜
ä»Šå¤©ï¼Œè¿è¡Œ `pm2` æ—¶å‡ºçŽ°å¦‚ä¸‹æŠ¥é”™ï¼š

```Shell
......
......
npm ERR! peer dep missing: eslint@>= 4.12.1, required by babel-eslint@10.0.1

npm ERR! peer dep missing: acorn@^6.0.0, required by acorn-jsx@5.0.1
```

çœ‹é”™è¯¯åŽŸå› æ˜¯ç¼ºå°‘ `eslint` ä¾èµ–ï¼Œæ‰§è¡Œä»¥ä¸‹å‘½ä»¤å®‰è£…å³å¯ï¼š

``` Shell
npm install eslint@>=4.12.1
npm install acorn@^6.0.0
```
























